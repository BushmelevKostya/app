<div class="home-container">
  <header class="header">
    <button class="menu-btn" (click)="changeMenuOpen()">Меню</button>
    <h1>Лабораторная работа</h1>
    <button class="login-btn" (click)="navigateTo('/login')">Войти</button>
  </header>

  <div class="side-menu" [class.open]="menuOpen">
    <ul>
      <li><a (click)="navigateTo('/visualize')">Визуализация объектов</a></li>
      <li><a (click)="navigateTo('/admin-login')">Зайти как администратор</a></li>
      <li><a (click)="navigateTo('/register')">Зарегистрироваться</a></li>
    </ul>
  </div>

  <div class="search-bar">
    <input type="text" placeholder="Искать по ID..." />
    <button (click)="changeSearchFlag()">Поиск</button>
  </div>

  <div class="movie-actions">
    <button (click)="changeCreateFlag()">Создать фильм</button>
  </div>

  <table class="movie-table">
    <thead>
    <tr>
      <th (click)="sortTable('name')">Название</th>
      <th (click)="sortTable('oscarsCount')">Оскары</th>
      <th (click)="sortTable('budget')">Бюджет</th>
      <th (click)="sortTable('totalBoxOffice')">Сборы</th>
      <th (click)="sortTable('mpaaRating')">MPAA Рейтинг</th>
      <th>Действия</th>
    </tr>
    </thead>
    <tbody>
    <tr *ngFor="let movie of movies">
      <td>{{ movie.name }}</td>
      <td>{{ movie.oscarsCount }}</td>
      <td>{{ movie.budget }}</td>
      <td>{{ movie.totalBoxOffice }}</td>
      <td>{{ movie.mpaaRating }}</td>
      <td>
        <button (click)="changeUpdateFlag()">Обновить</button>
        <button class="delete-btn" (click)="changeDeleteFlag()">Удалить</button>
      </td>
    </tr>
    </tbody>
  </table>

  <!-- Модальное окно для создания фильма -->
  <div class="modal" *ngIf=createFlag>
    <div class="modal-content">
      <span class="close-btn" (click)="changeCreateFlag()">&times;</span>
      <h2>Создать фильм</h2>
      <form (ngSubmit)="createMovie()">
        <label for="name">Название</label>
        <input type="text" id="name1" [(ngModel)]="movie.name" name="name" required />

        <label for="oscarsCount">Количество Оскаров</label>
        <input type="number" id="oscarsCount1" [(ngModel)]="movie.oscarsCount" name="oscarsCount" required />

        <label for="budget">Бюджет</label>
        <input type="number" id="budget1" [(ngModel)]="movie.budget" name="budget" required />

        <label for="totalBoxOffice">Сборы</label>
        <input type="number" id="totalBoxOffice1" [(ngModel)]="movie.totalBoxOffice" name="totalBoxOffice" required />

        <label for="mpaaRating">MPAA Рейтинг</label>
        <select id="mpaaRating1" [(ngModel)]="movie.mpaaRating" name="mpaaRating" required>
          <option *ngFor="let rating of movie.mpaaRating" [value]="rating">{{ rating }}</option>
        </select>

        <button type="submit">Создать</button>
      </form>
    </div>
  </div>

  <div class="modal" *ngIf="updateFlag">
    <div class="modal-content">
      <span class="close-btn" (click)="changeUpdateFlag()">&times;</span>
      <h2>Обновить фильм</h2>
      <form (ngSubmit)="updateMovie(movie.id)">
        <label for="name">Название</label>
        <input type="text" id="name" [(ngModel)]="movie.name" name="name" required />

        <label for="oscarsCount">Количество Оскаров</label>
        <input type="number" id="oscarsCount" [(ngModel)]="movie.oscarsCount" name="oscarsCount" required />

        <label for="budget">Бюджет</label>
        <input type="number" id="budget" [(ngModel)]="movie.budget" name="budget" required />

        <label for="totalBoxOffice">Сборы</label>
        <input type="number" id="totalBoxOffice" [(ngModel)]="movie.totalBoxOffice" name="totalBoxOffice" required />

        <label for="mpaaRating">MPAA Рейтинг</label>
        <select id="mpaaRating" [(ngModel)]="movie.mpaaRating" name="mpaaRating" required>
          <option *ngFor="let rating of movie.mpaaRating" [value]="rating">{{ rating }}</option>
        </select>

        <button type="submit">Обновить</button>
      </form>
    </div>
  </div>

  <div class="modal" *ngIf="deleteFlag">
    <div class="modal-content">
      <span class="close-btn" (click)="changeDeleteFlag()">&times;</span>
      <h2>Удалить фильм</h2>
      <p>Вы уверены, что хотите удалить фильм "{{ movie.name }}"?</p>
      <button (click)="deleteMovie(movie.id)">Да</button>
      <button (click)="toDoMethod()">Нет</button>
    </div>
  </div>

  <div class="modal" *ngIf="searchFlag">
    <div class="modal-content">
      <span class="close-btn" (click)="changeSearchFlag()">&times;</span>
      <h2>Поиск фильма</h2>
      <form (ngSubmit)="toDoMethod()">
        <label for="searchId">ID фильма</label>
        <input type="number" id="searchId" [(ngModel)]="searchId" name="searchId" required />

        <button type="submit">Найти</button>
      </form>
    </div>
  </div>

</div>
