<div class="home-container">
  <header class="header">
    <div class="menu-container">
      <button class="menu-btn" (click)="changeMenuOpen()">&#9776; Меню</button>
    </div>

    <h1>Лабораторная работа</h1>

    <div class="user-info-container">
      <div *ngIf="isUserLoggedIn" class="user-info-box">
        <span class="user-email">{{ loggedInUserEmail }}</span>
        <button *ngIf="isAdmin" class="notification-btn" (click)="changeNotsFlag()">
          <i class="fa fa-bell"></i>
          <span class="notification-count">{{ 1 }}</span>
        </button>
      </div>

      <button class="login-btn" (click)="isUserLoggedIn ? logout() : navigateTo('/login')">
        {{ isUserLoggedIn ? 'Выйти' : 'Войти' }}
      </button>
    </div>
  </header>

  <div class="side-menu" [class.open]="menuOpen">
    <ul>
      <li><a (click)="navigateTo('/visualize')">Визуализация объектов</a></li>
      <li><a (click)="navigateTo('/register')">Зарегистрироваться</a></li>
    </ul>
  </div>

  <div class="movie-actions">
    <button (click)="changeCreateFlag()">Создать фильм</button>
    <button (click)="changeSearchFlag()">Поиск</button>
    <button (click)="findDirectorWithMinMovies()">Найти режиссера с минимальным количеством фильмов</button>
    <button (click)="changeTaglineSearchFlag()">Поиск по Tagline</button>
    <button (click)="findUniqueUsaBoxOffices()">Уникальные значения USA Box Office</button>
    <button (click)="findOperatorsWithoutOscars()">Операторы без Оскаров</button>
    <button (click)="addOscarToRratedMovies()">Добавить Оскар фильмам с рейтингом R</button>
  </div>

  <!-- Табличка -->
  <div class="table-wrapper">
    <table class="movie-table">
      <thead>
      <tr>
        <th>ID</th>
        <th>Name</th>
        <th>Creation Date</th>
        <th>Oscars Count</th>
        <th>Budget</th>
        <th>Total Box Office</th>
        <th>MPAA Rating</th>
        <th>Length</th>
        <th>Golden Palm Count</th>
        <th>USA Box Office</th>
        <th>Tagline</th>
        <th>Genre</th>
        <th>Coordinates</th>
        <th>Director</th>
        <th>Screenwriter</th>
        <th>Operator</th>
        <th>Actions</th>
      </tr>
      </thead>
      <tbody>
      <tr *ngFor="let movie of movies | async">
        <td>{{ movie.id }}</td>
        <td>{{ movie.name }}</td>
        <td>{{ movie.creationDate }}</td>
        <td>{{ movie.oscarsCount }}</td>
        <td>{{ movie.budget }}</td>
        <td>{{ movie.totalBoxOffice }}</td>
        <td>{{ movie.mpaaRating }}</td>
        <td>{{ movie.length }}</td>
        <td>{{ movie.goldenPalmCount }}</td>
        <td>{{ movie.usaBoxOffice }}</td>
        <td>{{ movie.tagline }}</td>
        <td>{{ movie.genre }}</td>

        <!-- Coordinates -->
        <td>
          <div class="attribute-label">X:</div>
          <div>{{ movie.coordinates.x }}</div>
          <div class="attribute-label">Y:</div>
          <div>{{ movie.coordinates.y }}</div>
        </td>

        <!-- Director -->
        <td>
          <div class="object-header">Director's info</div>
          <div class="object-attributes">
            <div>Name: {{ movie.director.name }}</div>
            <div>Eye Color: {{ movie.director.eyeColor }}</div>
            <div>Hair Color: {{ movie.director.hairColor }}</div>
            <div>Location: {{ movie.director.location.name }} ({{ movie.director.location.x }}
              , {{ movie.director.location.y }}, {{ movie.director.location.z }})
            </div>
            <div>Height: {{ movie.director.height }}</div>
            <div>Nationality: {{ movie.director.nationality }}</div>
          </div>
        </td>

        <!-- Screenwriter -->
        <td>
          <div class="object-header">Screenwriter's info</div>
          <div class="object-attributes">
            <div>Name: {{ movie.screenwriter.name }}</div>
            <div>Eye Color: {{ movie.screenwriter.eyeColor }}</div>
            <div>Hair Color: {{ movie.screenwriter.hairColor }}</div>
            <div>Location: {{ movie.screenwriter.location.name }} ({{ movie.screenwriter.location.x }}
              , {{ movie.screenwriter.location.y }}, {{ movie.screenwriter.location.z }})
            </div>
            <div>Height: {{ movie.screenwriter.height }}</div>
            <div>Nationality: {{ movie.screenwriter.nationality }}</div>
          </div>
        </td>

        <!-- Operator -->
        <td>
          <div class="object-header">Operator's info</div>
          <div class="object-attributes">
            <div>Name: {{ movie.operator.name }}</div>
            <div>Eye Color: {{ movie.operator.eyeColor }}</div>
            <div>Hair Color: {{ movie.operator.hairColor }}</div>
            <div>Location: {{ movie.operator.location.name }} ({{ movie.operator.location.x }}
              , {{ movie.operator.location.y }}, {{ movie.operator.location.z }})
            </div>
            <div>Height: {{ movie.operator.height }}</div>
            <div>Nationality: {{ movie.operator.nationality }}</div>
          </div>
        </td>

        <td *ngIf="isMovieCreator(movie)">
          <button (click)="openUpdateModal(movie.id)">Обновить</button>
          <button (click)="openDeleteModal(movie.id)">Удалить</button>
        </td>
      </tr>
      </tbody>
    </table>
  </div>

  <!-- Модальное окно для создания фильма -->
  <div class="modal" *ngIf="createFlag">
    <div class="modal-content">
      <span class="close-btn" (click)="changeCreateFlag()">&times;</span>
      <h2>Создать фильм</h2>
      <form [formGroup]="movieCreateForm" (ngSubmit)="createMovie()">
        <div class="first-group">
          <!-- Основная информация о фильме -->
          <fieldset class="fieldset-group">
            <legend>Основная информация</legend>
            <div class="field-group">
              <label for="nameCreate">Название:</label>
              <input id="nameCreate" formControlName="name" class="compact-input"/>
            </div>
            <div class="field-group">
              <label for="creationDateCreate">Дата создания:</label>
              <input id="creationDateCreate" formControlName="creationDate" class="compact-input"/>
            </div>
            <div class="field-group">
              <label for="oscarsCountCreate">Количество Оскаров:</label>
              <input id="oscarsCountCreate" type="number" formControlName="oscarsCount" class="compact-input"/>
            </div>
            <div class="field-group">
              <label for="budgetCreate">Бюджет:</label>
              <input id="budgetCreate" type="number" formControlName="budget" class="compact-input"/>
            </div>
            <div class="field-group">
              <label for="totalBoxOfficeCreate">Сборы:</label>
              <input id="totalBoxOfficeCreate" type="number" formControlName="totalBoxOffice" class="compact-input"/>
            </div>
            <div class="field-group">
              <label for="mpaaRatingCreate">Рейтинг MPAA:</label>
              <select id="mpaaRatingCreate" formControlName="mpaaRating" class="compact-input">
                <option value="G">G</option>
                <option value="PG">PG</option>
                <option value="PG_13">PG-13</option>
                <option value="R">R</option>
              </select>
            </div>
            <div class="field-group">
              <label for="lengthCreate">Продолжительность:</label>
              <input id="lengthCreate" type="number" formControlName="length" class="compact-input"/>
            </div>
          </fieldset>

          <!-- Дополнительные параметры -->
          <fieldset class="fieldset-group">
            <legend>Дополнительные параметры</legend>
            <div class="field-group">
              <label for="goldenPalmCountCreate">Золотая пальма:</label>
              <input id="goldenPalmCountCreate" type="number" formControlName="goldenPalmCount" class="compact-input"/>
            </div>
            <div class="field-group">
              <label for="usaBoxOfficeCreate">Сборы в США:</label>
              <input id="usaBoxOfficeCreate" type="number" formControlName="usaBoxOffice" class="compact-input"/>
            </div>
            <div class="field-group">
              <label for="taglineCreate">Слоган:</label>
              <input id="taglineCreate" formControlName="tagline" class="compact-input"/>
            </div>
            <div class="field-group">
              <label for="genreCreate">Жанр:</label>
              <select id="genreCreate" formControlName="genre" class="compact-input">
                <option value="ACTION">Экшен</option>
                <option value="TRAGEDY">Трагедия</option>
                <option value="THRILLER">Триллер</option>
                <option value="FANTASY">Фэнтези</option>
                <option value="SCIENCE_FICTION">Научная фантастика</option>
              </select>
            </div>
          </fieldset>
        </div>

        <div class="first-group">
          <!-- Блок Coordinates -->
          <fieldset class="fieldset-group">
            <legend>Координаты</legend>


            <button type="button" (click)="toggleCoordinates()">Создать координаты</button>
            <div *ngIf="coordinatesVisible" formGroupName="coordinates">
              <fieldset class="fieldset-group">
                <label for="idCoordinatesCreate">ID:</label>
                <input id="idCoordinatesCreate" formControlName="id" placeholder="Генерируется автоматически" readonly
                       class="compact-input"/>
                <label for="xCreate">X:</label>
                <input id="xCreate" type="number" formControlName="x" class="compact-input"/>
                <label for="yCreate">Y:</label>
                <input id="yCreate" type="number" formControlName="y" class="compact-input"/>

              </fieldset>
              <fieldset class="fieldset-group">
                <div>
                  <button type="button" (click)="loadExistingCoordinates()">Загрузить координаты</button>
                  <ul *ngIf="existingCoordinates.length > 0">
                    <li *ngFor="let coordinate of existingCoordinates" (click)="selectCoordinate(coordinate)">
                      {{ coordinate.id }}, {{ coordinate.x }}, {{ coordinate.y }}
                    </li>
                  </ul>
                </div>
              </fieldset>
            </div>
          </fieldset>

          <!-- Блок Director -->
          <fieldset class="fieldset-group">
            <legend>Режиссер</legend>
            <button type="button" (click)="toggleDirector()">Создать режиссера</button>
            <div *ngIf="directorVisible" formGroupName="director">

              <fieldset class="fieldset-group">

                <label for="idDirectorCreate">ID:</label>
                <input id="idDirectorCreate" formControlName="id" placeholder="Генерируется автоматически" readonly
                       class="compact-input"/>
                <label for="directorNameCreate">Имя:</label>
                <input id="directorNameCreate" formControlName="name" class="compact-input"/>
                <label for="directorEyeColorCreate">Цвет глаз:</label>
                <select id="directorEyeColorCreate" formControlName="eyeColor" class="compact-input">
                  <option value="BLACK">Черный</option>
                  <option value="ORANGE">Оранжевый</option>
                  <option value="BROWN">Коричневый</option>
                </select>
                <label for="directorHairColorCreate">Цвет волос:</label>
                <select id="directorHairColorCreate" formControlName="hairColor" class="compact-input">
                  <option value="BLACK">Черный</option>
                  <option value="ORANGE">Оранжевый</option>
                  <option value="BROWN">Коричневый</option>
                </select>
                <label for="directorHeightCreate">Рост:</label>
                <input id="directorHeightCreate" type="number" formControlName="height" class="compact-input"/>
                <label for="directorNationalityCreate">Национальность:</label>
                <select id="directorNationalityCreate" formControlName="nationality" class="compact-input">
                  <option value="SPAIN">Испания</option>
                  <option value="INDIA">Индия</option>
                  <option value="VATICAN">Ватикан</option>
                </select>

              </fieldset>

              <fieldset class="fieldset-group">
                <!-- Вложенный блок для Location -->
                <legend>Location</legend>
                <button type="button" (click)="toggleDirectorLocation()">Создать Location</button>
                <div *ngIf="directorLocationVisible" formGroupName="location">

                  <fieldset class="fieldset-group">

                    <label for="idDirectorLocationCreate">ID:</label>
                    <input id="idDirectorLocationCreate" formControlName="id" placeholder="Генерируется автоматически"
                           readonly class="compact-input"/>

                    <label for="directorLocationXCreate">X:</label>
                    <input id="directorLocationXCreate" type="number" formControlName="x" class="compact-input"/>

                    <label for="directorLocationYCreate">Y:</label>
                    <input id="directorLocationYCreate" type="number" formControlName="y" class="compact-input"/>

                    <label for="directorLocationZCreate">Z:</label>
                    <input id="directorLocationZCreate" type="number" formControlName="z" class="compact-input"/>

                    <label for="directorLocationNameCreate">Название:</label>
                    <input id="directorLocationNameCreate" formControlName="name" class="compact-input"/>

                  </fieldset>
                  <fieldset class="fieldset-group">
                    <div>
                      <button type="button" (click)="loadExistingLocations()">Загрузить существующие локации</button>
                      <ul *ngIf="existingLocations.length > 0">
                        <li *ngFor="let location of existingLocations" (click)="selectDirectorLocation(location)">
                          {{ location.id }}, {{ location.name }}
                        </li>
                      </ul>
                    </div>
                  </fieldset>
                </div>
              </fieldset>
              <fieldset class="fieldset-group">
                <div>
                  <button type="button" (click)="loadExistingPersons()">Загрузить существующих Directors</button>
                  <ul *ngIf="existingDirectors.length > 0">
                    <li *ngFor="let director of existingDirectors" (click)="selectDirector(director)">
                      {{ director.id }}, {{ director.name }}
                    </li>
                  </ul>
                </div>
              </fieldset>
            </div>
          </fieldset>
        </div>

        <div class="first-group">
          <!-- Блок для Screenwriter -->
          <fieldset class="fieldset-group">
            <legend>Screenwriter</legend>
            <button type="button" (click)="toggleScreenwriter()">Создать Screenwriter</button>
            <div *ngIf="screenwriterVisible" formGroupName="screenwriter">

              <fieldset class="fieldset-group">

                <label for="idScreenwriterCreate">ID:</label>
                <input id="idScreenwriterCreate" formControlName="id" placeholder="Генерируется автоматически" readonly
                       class="compact-input"/>

                <label for="screenwriterPersonNameCreate">Имя:</label>
                <input id="screenwriterPersonNameCreate" formControlName="name" class="compact-input"/>

                <label for="screenwriterEyeColorCreate">Цвет глаз:</label>
                <select id="screenwriterEyeColorCreate" formControlName="eyeColor" class="compact-input">
                  <option value="BLACK">Черный</option>
                  <option value="ORANGE">Оранжевый</option>
                  <option value="BROWN">Коричневый</option>
                </select>

                <label for="screenwriterHairColorCreate">Цвет волос:</label>
                <select id="screenwriterHairColorCreate" formControlName="hairColor" class="compact-input">
                  <option value="BLACK">Черный</option>
                  <option value="ORANGE">Оранжевый</option>
                  <option value="BROWN">Коричневый</option>
                </select>

                <label for="screenwriterHeightCreate">Рост:</label>
                <input id="screenwriterHeightCreate" type="number" formControlName="height" class="compact-input"/>

                <label for="screenwriterNationalityCreate">Национальность:</label>
                <select id="screenwriterNationalityCreate" formControlName="nationality" class="compact-input">
                  <option value="SPAIN">Испания</option>
                  <option value="INDIA">Индия</option>
                  <option value="VATICAN">Ватикан</option>
                </select>
              </fieldset>
              <fieldset class="fieldset-group">
                <!-- Вложенный блок для Location -->
                <legend>Location</legend>
                <button type="button" (click)="toggleScreenwriterLocation()">Создать Location</button>
                <div *ngIf="screenwriterLocationVisible" formGroupName="location">

                  <fieldset class="fieldset-group">

                    <label for="idScreenwriterLocationCreate">ID:</label>
                    <input id="idScreenwriterLocationCreate" formControlName="id"
                           placeholder="Генерируется автоматически"
                           readonly class="compact-input"/>

                    <label for="screenwriterLocationXCreate">X:</label>
                    <input id="screenwriterLocationXCreate" type="number" formControlName="x" class="compact-input"/>

                    <label for="screenwriterLocationYCreate">Y:</label>
                    <input id="screenwriterLocationYCreate" type="number" formControlName="y" class="compact-input"/>

                    <label for="screenwriterLocationZCreate">Z:</label>
                    <input id="screenwriterLocationZCreate" type="number" formControlName="z" class="compact-input"/>

                    <label for="screenwriterLocationNameCreate">Название:</label>
                    <input id="screenwriterLocationNameCreate" formControlName="name" class="compact-input"/>
                  </fieldset>
                  <fieldset class="fieldset-group">
                    <div>
                      <button type="button" (click)="loadExistingLocations()">Загрузить существующие локации</button>
                      <ul *ngIf="existingLocations.length > 0">
                        <li *ngFor="let location of existingLocations" (click)="selectScreenwriterLocation(location)">
                          {{ location.id }}, {{ location.name }}
                        </li>
                      </ul>
                    </div>
                  </fieldset>
                </div>
              </fieldset>
              <fieldset class="fieldset-group">
                <div>
                  <button type="button" (click)="loadExistingPersons()">Загрузить существующих Screenwriters</button>
                  <ul *ngIf="existingScreenwriters.length > 0">
                    <li *ngFor="let screenwriter of existingScreenwriters" (click)="selectScreenwriter(screenwriter)">
                      {{ screenwriter.id }}, {{ screenwriter.name }}
                    </li>
                  </ul>
                </div>
              </fieldset>
            </div>
          </fieldset>

          <!-- Блок для Operator -->
          <fieldset class="fieldset-group">
            <legend>Operator</legend>
            <button type="button" (click)="toggleOperator()">Создать Operator</button>
            <div *ngIf="operatorVisible" formGroupName="operator">

              <fieldset class="fieldset-group">

                <label for="idOperatorCreate">ID:</label>
                <input id="idOperatorCreate" formControlName="id" placeholder="Генерируется автоматически" readonly
                       class="compact-input"/>

                <label for="operatorNameCreate">Имя:</label>
                <input id="operatorNameCreate" formControlName="name" class="compact-input"/>

                <label for="operatorEyeColorCreate">Цвет глаз:</label>
                <select id="operatorEyeColorCreate" formControlName="eyeColor" class="compact-input">
                  <option value="BLACK">Черный</option>
                  <option value="ORANGE">Оранжевый</option>
                  <option value="BROWN">Коричневый</option>
                </select>

                <label for="operatorHairColorCreate">Цвет волос:</label>
                <select id="operatorHairColorCreate" formControlName="hairColor" class="compact-input">
                  <option value="BLACK">Черный</option>
                  <option value="ORANGE">Оранжевый</option>
                  <option value="BROWN">Коричневый</option>
                </select>

                <label for="operatorHeightCreate">Рост:</label>
                <input id="operatorHeightCreate" type="number" formControlName="height" class="compact-input"/>

                <label for="operatorNationalityCreate">Национальность:</label>
                <select id="operatorNationalityCreate" formControlName="nationality" class="compact-input">
                  <option value="SPAIN">Испания</option>
                  <option value="INDIA">Индия</option>
                  <option value="VATICAN">Ватикан</option>
                </select>
              </fieldset>
              <fieldset class="fieldset-group">
                <!-- Вложенный блок для Location -->
                <legend>Location</legend>
                <button type="button" (click)="toggleOperatorLocation()">Создать Location</button>
                <div *ngIf="operatorLocationVisible" formGroupName="location">
                  <fieldset class="fieldset-group">
                    <label for="idOperatorLocationCreate">ID:</label>
                    <input id="idOperatorLocationCreate" formControlName="id" placeholder="Генерируется автоматически"
                           readonly class="compact-input"/>

                    <label for="operatorLocationXCreate">X:</label>
                    <input id="operatorLocationXCreate" type="number" formControlName="x" class="compact-input"/>

                    <label for="operatorLocationYCreate">Y:</label>
                    <input id="operatorLocationYCreate" type="number" formControlName="y" class="compact-input"/>

                    <label for="operatorLocationZCreate">Z:</label>
                    <input id="operatorLocationZCreate" type="number" formControlName="z" class="compact-input"/>

                    <label for="operatorLocationNameCreate">Название:</label>
                    <input id="operatorLocationNameCreate" formControlName="name" class="compact-input"/>
                  </fieldset>
                  <fieldset class="fieldset-group">
                    <div>
                      <button type="button" (click)="loadExistingLocations()">Загрузить существующие локации</button>
                      <ul *ngIf="existingLocations.length > 0">
                        <li *ngFor="let location of existingLocations" (click)="selectOperatorLocation(location)">
                          {{ location.id }}, {{ location.name }}
                        </li>
                      </ul>
                    </div>
                  </fieldset>
                </div>
              </fieldset>
              <fieldset class="fieldset-group">
                <div>
                  <button type="button" (click)="loadExistingPersons()">Загрузить существующих Operators</button>
                  <ul *ngIf="existingOperators.length > 0">
                    <li *ngFor="let operator of existingOperators" (click)="selectOperator(operator)">
                      {{ operator.id }}, {{ operator.name }}
                    </li>
                  </ul>
                </div>
              </fieldset>
            </div>
          </fieldset>
        </div>

        <button type="submit">Create Movie</button>
      </form>
    </div>
  </div>

  <!-- Модальное окно для обновления фильма -->
  <div class="modal" *ngIf="updateFlag">
    <div class="modal-content">
      <span class="close-btn" (click)="changeUpdateFlag()">&times;</span>
      <h2>Обновить фильм</h2>
      <form [formGroup]="movieUpdateForm" (ngSubmit)="updateMovie()">
        <label for="nameUpdate">Name:</label>
        <input id="nameUpdate" formControlName="name"/>

        <label for="creationDateUpdate">Creation Date: </label>
        <input id="creationDateUpdate" formControlName="creationDate"/>

        <label for="oscarsCountUpdate">Oscars Count:</label>
        <input id="oscarsCountUpdate" type="number" formControlName="oscarsCount"/>

        <label for="budgetUpdate">Budget:</label>
        <input id="budgetUpdate" type="number" formControlName="budget"/>

        <label for="totalBoxOfficeUpdate">Total Box Office:</label>
        <input id="totalBoxOfficeUpdate" type="number" formControlName="totalBoxOffice"/>

        <label for="mpaaRatingUpdate">MPAA Rating:</label>
        <select id="mpaaRatingUpdate" formControlName="mpaaRating">
          <option value="G">G</option>
          <option value="PG">PG</option>
          <option value="PG_13">PG-13</option>
          <option value="R">R</option>
        </select>

        <label for="lengthUpdate">Length:</label>
        <input id="lengthUpdate" type="number" formControlName="length"/>

        <label for="goldenPalmCountUpdate">Golden Palm Count:</label>
        <input id="goldenPalmCountUpdate" type="number" formControlName="goldenPalmCount"/>

        <label for="usaBoxOfficeUpdate">Usa Box Office:</label>
        <input id="usaBoxOfficeUpdate" type="number" formControlName="usaBoxOffice"/>

        <label for="taglineUpdate">Tagline:</label>
        <input id="taglineUpdate" formControlName="tagline"/>

        <label for="genreUpdate">Genre:</label>
        <select id="genreUpdate" formControlName="genre">
          <option value="ACTION">ACTION</option>
          <option value="TRAGEDY">TRAGEDY</option>
          <option value="THRILLER">THRILLER</option>
          <option value="FANTASY">FANTASY</option>
          <option value="SCIENCE_FICTION">SCIENCE_FICTION</option>
        </select>

        <!-- Блок для Coordinates -->
        <button type="button" (click)="toggleCoordinates()">Update Coordinates</button>
        <div *ngIf="coordinatesVisible" formGroupName="coordinates">
          <h3>Coordinates</h3>
          <label for="idCoordinatesUpdate">ID:</label>
          <input id="idCoordinatesUpdate" formControlName="id" placeholder="Will be generate automatically" readonly/>

          <label for="xUpdate">X:</label>
          <input id="xUpdate" type="number" formControlName="x"/>

          <label for="yUpdate">Y:</label>
          <input id="yUpdate" type="number" formControlName="y"/>

          <div>
            <button type="button" (click)="loadExistingCoordinates()">Load Existing Coordinates</button>
            <ul *ngIf="existingCoordinates.length > 0">
              <li *ngFor="let coordinate of existingCoordinates" (click)="selectCoordinate(coordinate)">
                {{ coordinate.id }}, {{ coordinate.x }}, {{ coordinate.y }}
              </li>
            </ul>
          </div>
        </div>

        <!-- Блок для Person -->
        <button type="button" (click)="toggleDirector()">Update Director</button>
        <div *ngIf="directorVisible" formGroupName="director">
          <h3>Director</h3>
          <label for="idDirectorUpdate">ID:</label>
          <input id="idDirectorUpdate" formControlName="id" placeholder="Will be generate automatically" readonly/>

          <label for="directorNameUpdate">director Name:</label>
          <input id="directorNameUpdate" formControlName="name"/>

          <label for="directorEyeColorUpdate">Eye Color:</label>
          <select id="directorEyeColorUpdate" formControlName="eyeColor">
            <option value="BLACK">BLACK</option>
            <option value="ORANGE">ORANGE</option>
            <option value="BROWN">BROWN</option>
          </select>

          <label for="directorHairColorUpdate">Hair Color:</label>
          <select id="directorHairColorUpdate" formControlName="hairColor">
            <option value="BLACK">BLACK</option>
            <option value="ORANGE">ORANGE</option>
            <option value="BROWN">BROWN</option>
          </select>

          <label for="directorHeightUpdate">Height:</label>
          <input id="directorHeightUpdate" type="number" formControlName="height"/>

          <label for="directorNationalityUpdate">Nationality:</label>
          <select id="directorNationalityUpdate" formControlName="nationality">
            <option value="SPAIN">SPAIN</option>
            <option value="INDIA">INDIA</option>
            <option value="VATICAN">VATICAN</option>
          </select>

          <!-- Вложенный блок для Location -->
          <button type="button" (click)="toggleDirectorLocation()">Update Location</button>
          <div *ngIf="directorLocationVisible" formGroupName="location">
            <h4>Location</h4>
            <label for="idDirectorLocationUpdate">ID:</label>
            <input id="idDirectorLocationUpdate" formControlName="id" placeholder="Will be generate automatically"
                   readonly/>

            <label for="directorLocationXUpdate">Location X:</label>
            <input id="directorLocationXUpdate" type="number" formControlName="x"/>

            <label for="directorLocationYUpdate">Location Y:</label>
            <input id="directorLocationYUpdate" type="number" formControlName="y"/>

            <label for="directorLocationZUpdate">Location Z:</label>
            <input id="directorLocationZUpdate" type="number" formControlName="z"/>

            <label for="directorLocationNameUpdate">Location Name:</label>
            <input id="directorLocationNameUpdate" formControlName="name"/>

            <div>
              <button type="button" (click)="loadExistingLocations()">Load Existing Locations</button>
              <ul *ngIf="existingLocations.length > 0">
                <li *ngFor="let location of existingLocations" (click)="selectDirectorLocation(location)">
                  {{ location.id }}, {{ location.name }}
                </li>
              </ul>
            </div>
          </div>

          <div>
            <button type="button" (click)="loadExistingPersons()">Load Existing Directors</button>
            <ul *ngIf="existingDirectors.length > 0">
              <li *ngFor="let director of existingDirectors" (click)="selectDirector(director)">
                {{ director.id }}, {{ director.name }}
              </li>
            </ul>
          </div>
        </div>

        <button type="button" (click)="toggleScreenwriter()">Update Screenwriter</button>
        <div *ngIf="screenwriterVisible" formGroupName="screenwriter">
          <h3>Screenwriter</h3>
          <label for="idScreenwriterUpdate">ID:</label>
          <input id="idScreenwriterUpdate" formControlName="id" placeholder="Will be generate automatically" readonly/>

          <label for="screenwriterPersonNameUpdate">Name:</label>
          <input id="screenwriterPersonNameUpdate" formControlName="name"/>

          <label for="screenwriterEyeColorUpdate">Eye Color:</label>
          <select id="screenwriterEyeColorUpdate" formControlName="eyeColor">
            <option value="BLACK">BLACK</option>
            <option value="ORANGE">ORANGE</option>
            <option value="BROWN">BROWN</option>
          </select>

          <label for="screenwriterHairColorUpdate">Hair Color:</label>
          <select id="screenwriterHairColorUpdate" formControlName="hairColor">
            <option value="BLACK">BLACK</option>
            <option value="ORANGE">ORANGE</option>
            <option value="BROWN">BROWN</option>
          </select>

          <label for="screenwriterHeightUpdate">Height:</label>
          <input id="screenwriterHeightUpdate" type="number" formControlName="height"/>

          <label for="screenwriterNationalityUpdate">Nationality:</label>
          <select id="screenwriterNationalityUpdate" formControlName="nationality">
            <option value="SPAIN">SPAIN</option>
            <option value="INDIA">INDIA</option>
            <option value="VATICAN">VATICAN</option>
          </select>

          <!-- Вложенный блок для Location -->
          <button type="button" (click)="toggleScreenwriterLocation()">Update Location</button>
          <div *ngIf="screenwriterLocationVisible" formGroupName="location">
            <h4>Location</h4>
            <label for="idScreenwriterLocationUpdate">ID:</label>
            <input id="idScreenwriterLocationUpdate" formControlName="id" placeholder="Will be generate automatically"
                   readonly/>

            <label for="screenwriterLocationXUpdate">Location X:</label>
            <input id="screenwriterLocationXUpdate" type="number" formControlName="x"/>

            <label for="screenwriterLocationYUpdate">Location Y:</label>
            <input id="screenwriterLocationYUpdate" type="number" formControlName="y"/>

            <label for="screenwriterLocationZUpdate">Location Z:</label>
            <input id="screenwriterLocationZUpdate" type="number" formControlName="z"/>

            <label for="screenwriterLocationNameUpdate">Location Name:</label>
            <input id="screenwriterLocationNameUpdate" formControlName="name"/>

            <div>
              <button type="button" (click)="loadExistingLocations()">Load Existing Locations</button>
              <ul *ngIf="existingLocations.length > 0">
                <li *ngFor="let location of existingLocations" (click)="selectScreenwriterLocation(location)">
                  {{ location.id }}, {{ location.name }}
                </li>
              </ul>
            </div>
          </div>

          <div>
            <button type="button" (click)="loadExistingPersons()">Load Existing Screenwriters</button>
            <ul *ngIf="existingScreenwriters.length > 0">
              <li *ngFor="let screenwriter of existingScreenwriters" (click)="selectScreenwriter(screenwriter)">
                {{ screenwriter.id }}, {{ screenwriter.name }}
              </li>
            </ul>
          </div>
        </div>

        <button type="button" (click)="toggleOperator()">Update Operator</button>
        <div *ngIf="operatorVisible" formGroupName="operator">
          <h3>Person</h3>
          <label for="idOperatorUpdate">ID:</label>
          <input id="idOperatorUpdate" formControlName="id" placeholder="Will be generate automatically" readonly/>

          <label for="operatorNameUpdate">Name:</label>
          <input id="operatorNameUpdate" formControlName="name"/>

          <label for="operatorEyeColorUpdate">Eye Color:</label>
          <select id="operatorEyeColorUpdate" formControlName="eyeColor">
            <option value="BLACK">BLACK</option>
            <option value="ORANGE">ORANGE</option>
            <option value="BROWN">BROWN</option>
          </select>

          <label for="operatorHairColorUpdate">Hair Color:</label>
          <select id="operatorHairColorUpdate" formControlName="hairColor">
            <option value="BLACK">BLACK</option>
            <option value="ORANGE">ORANGE</option>
            <option value="BROWN">BROWN</option>
          </select>

          <label for="operatorHeightUpdate">Height:</label>
          <input id="operatorHeightUpdate" type="number" formControlName="height"/>

          <label for="operatorNationalityUpdate">Nationality:</label>
          <select id="operatorNationalityUpdate" formControlName="nationality">
            <option value="SPAIN">SPAIN</option>
            <option value="INDIA">INDIA</option>
            <option value="VATICAN">VATICAN</option>
          </select>

          <!-- Вложенный блок для Location -->
          <button type="button" (click)="toggleOperatorLocation()">Update Location</button>
          <div *ngIf="operatorLocationVisible" formGroupName="location">
            <h4>Location</h4>
            <label for="idOperatorLocationUpdate">ID:</label>
            <input id="idOperatorLocationUpdate" formControlName="id" placeholder="Will be generate automatically"
                   readonly/>

            <label for="operatorLocationXUpdate">Location X:</label>
            <input id="operatorLocationXUpdate" type="number" formControlName="x"/>

            <label for="operatorLocationYUpdate">Location Y:</label>
            <input id="operatorLocationYUpdate" type="number" formControlName="y"/>

            <label for="operatorLocationZUpdate">Location Z:</label>
            <input id="operatorLocationZUpdate" type="number" formControlName="z"/>

            <label for="operatorLocationNameUpdate">Location Name:</label>
            <input id="operatorLocationNameUpdate" formControlName="name"/>

            <div>
              <button type="button" (click)="loadExistingLocations()">Load Existing Locations</button>
              <ul *ngIf="existingLocations.length > 0">
                <li *ngFor="let location of existingLocations" (click)="selectOperatorLocation(location)">
                  {{ location.id }}, {{ location.name }}
                </li>
              </ul>
            </div>
          </div>

          <div>
            <button type="button" (click)="loadExistingPersons()">Load Existing Operators</button>
            <ul *ngIf="existingOperators.length > 0">
              <li *ngFor="let operator of existingOperators" (click)="selectOperator(operator)">
                {{ operator.id }}, {{ operator.name }}
              </li>
            </ul>
          </div>
        </div>

        <button type="submit">Update Movie</button>
      </form>
    </div>
  </div>

  <!-- Модальное окно для удаления фильма -->
  <div class="modal" *ngIf="deleteFlag">
    <div class="modal-content">
      <span class="close-btn" (click)="changeDeleteFlag()">&times;</span>
      <h2>Удалить фильм</h2>
      <p>Вы уверены, что хотите удалить фильм "{{ selectedMovieId }}"?</p>
      <button (click)="deleteMovie()">Да</button>
      <button (click)="changeDeleteFlag()">Нет</button>
    </div>
  </div>

  <!-- Модальное окно для поиска фильма -->
  <div class="modal" *ngIf="searchFlag">
    <div class="modal-content">
      <span class="close-btn" (click)="changeSearchFlag()">&times;</span>
      <h2>Поиск фильма</h2>
      <form (ngSubmit)="searchMovie()">
        <label for="searchId">ID фильма</label>
        <input type="number" id="searchId" [(ngModel)]="searchId" name="searchId" placeholder="Искать по ID..."
               required/>
        <button type="submit">Найти</button>
      </form>
      <div *ngIf="foundMovie; else notFound">
        <h3>Найденный фильм:</h3>
        <table>
          <thead>
          <tr>
            <th>ID</th>
            <th>Name</th>
            <th>Creation Date</th>
            <th>Oscars Count</th>
            <th>Budget</th>
            <th>Total Box Office</th>
            <th>MPAA Rating</th>
            <th>Length</th>
            <th>Golden Palm Count</th>
            <th>USA Box Office</th>
            <th>Tagline</th>
            <th>Genre</th>
            <th>Coordinates</th>
            <th>Director</th>
            <th>Screenwriter</th>
            <th>Operator</th>
          </tr>
          </thead>
          <tbody>
          <tr>
            <td>{{ foundMovie.id }}</td>
            <td>{{ foundMovie.name }}</td>
            <td>{{ foundMovie.creationDate }}</td>
            <td>{{ foundMovie.oscarsCount }}</td>
            <td>{{ foundMovie.budget }}</td>
            <td>{{ foundMovie.totalBoxOffice }}</td>
            <td>{{ foundMovie.mpaaRating }}</td>
            <td>{{ foundMovie.length }}</td>
            <td>{{ foundMovie.goldenPalmCount }}</td>
            <td>{{ foundMovie.usaBoxOffice }}</td>
            <td>{{ foundMovie.tagline }}</td>
            <td>{{ foundMovie.genre }}</td>

            <!-- Coordinates -->
            <td>
              <div class="attribute-label">X:</div>
              <div>{{ foundMovie.coordinates.x }}</div>
              <div class="attribute-label">Y:</div>
              <div>{{ foundMovie.coordinates.y }}</div>
            </td>

            <!-- Director -->
            <td>
              <div class="object-header">Director's info</div>
              <div class="object-attributes">
                <div>Name: {{ foundMovie.director.name }}</div>
                <div>Eye Color: {{ foundMovie.director.eyeColor }}</div>
                <div>Hair Color: {{ foundMovie.director.hairColor }}</div>
                <div>Location: {{ foundMovie.director.location.name }} ({{ foundMovie.director.location.x }}
                  , {{ foundMovie.director.location.y }}, {{ foundMovie.director.location.z }})
                </div>
                <div>Height: {{ foundMovie.director.height }}</div>
                <div>Nationality: {{ foundMovie.director.nationality }}</div>
              </div>
            </td>

            <!-- Screenwriter -->
            <td>
              <div class="object-header">Screenwriter's info</div>
              <div class="object-attributes">
                <div>Name: {{ foundMovie.screenwriter.name }}</div>
                <div>Eye Color: {{ foundMovie.screenwriter.eyeColor }}</div>
                <div>Hair Color: {{ foundMovie.screenwriter.hairColor }}</div>
                <div>Location: {{ foundMovie.screenwriter.location.name }} ({{ foundMovie.screenwriter.location.x }}
                  , {{ foundMovie.screenwriter.location.y }}, {{ foundMovie.screenwriter.location.z }})
                </div>
                <div>Height: {{ foundMovie.screenwriter.height }}</div>
                <div>Nationality: {{ foundMovie.screenwriter.nationality }}</div>
              </div>
            </td>

            <!-- Operator -->
            <td>
              <div class="object-header">Operator's info</div>
              <div class="object-attributes">
                <div>Name: {{ foundMovie.operator.name }}</div>
                <div>Eye Color: {{ foundMovie.operator.eyeColor }}</div>
                <div>Hair Color: {{ foundMovie.operator.hairColor }}</div>
                <div>Location: {{ foundMovie.operator.location.name }} ({{ foundMovie.operator.location.x }}
                  , {{ foundMovie.operator.location.y }}, {{ foundMovie.operator.location.z }})
                </div>
                <div>Height: {{ foundMovie.operator.height }}</div>
                <div>Nationality: {{ foundMovie.operator.nationality }}</div>
              </div>
            </td>
          </tr>
          </tbody>
        </table>
      </div>

      <ng-template #notFound>
        <p>Объект не найден</p>
      </ng-template>

    </div>
  </div>

  <!-- Модальное окно для уведомлений -->
  <div class="modal" *ngIf="notsFlag">
    <div class="modal-content">
      <h2>Заявки на администрирование</h2>
      <ul>
        <li *ngFor="let request of requests">
          {{ request.userEmail }}
          <button (click)="approveRequest(request.id)">Одобрить</button>
        </li>
      </ul>
      <button (click)="changeNotsFlag()">Закрыть</button>
    </div>
  </div>

  <!-- Модальное окно для операции 1: Режиссер с минимальным числом фильмов -->
  <div class="modal" *ngIf="minDirectorFlag">
    <div class="modal-content">
      <span class="close-btn" (click)="minDirectorFlag = false">&times;</span>
      <div *ngIf="minDirector; else notFound">
        <h2>Режиссер с минимальным количеством фильмов</h2>
        <table>
          <thead>
          <tr>
            <th>Director</th>
          </tr>
          </thead>
          <tbody>
          <tr>
            <!-- Director -->
            <td>
              <div class="object-header">Director's info</div>
              <div class="object-attributes">
                <div>Name: {{ minDirector.name }}</div>
                <div>Eye Color: {{ minDirector.eyeColor }}</div>
                <div>Hair Color: {{ minDirector.hairColor }}</div>
                <div>Location: {{ minDirector.location.name }} ({{ minDirector.location.x }}
                  , {{ minDirector.location.y }}, {{ minDirector.location.z }})
                </div>
                <div>Height: {{ minDirector.height }}</div>
                <div>Nationality: {{ minDirector.nationality }}</div>
              </div>
            </td>
          </tr>
          </tbody>
        </table>
      </div>

      <ng-template #notFound>
        <p>Объект не найден</p>
      </ng-template>
    </div>
  </div>

  <!--   Модальное окно для операции 2: Фильмы с Tagline больше заданного -->
  <div class="modal" *ngIf="taglineSearchFlag">
    <div class="modal-content">
      <span class="close-btn" (click)="changeTaglineSearchFlag()">&times;</span>
      <h2>Поиск фильмов по Tagline</h2>
      <form (ngSubmit)="searchByTagline(taglineInput)">
        <label for="taglineInput">Tagline больше чем:</label>
        <input type="text" id="taglineInput" [(ngModel)]="taglineInput" name="taglineInput" required/>
        <button type="submit">Поиск</button>
      </form>
      <div *ngIf="moviesWithTagline && moviesWithTagline.length > 0">
        <table>
          <thead>
          <tr>
            <th>ID</th>
            <th>Name</th>
            <th>Creation Date</th>
            <th>Oscars Count</th>
            <th>Budget</th>
            <th>Total Box Office</th>
            <th>MPAA Rating</th>
            <th>Length</th>
            <th>Golden Palm Count</th>
            <th>USA Box Office</th>
            <th>Tagline</th>
            <th>Genre</th>
            <th>Coordinates</th>
            <th>Director</th>
            <th>Screenwriter</th>
            <th>Operator</th>
          </tr>
          </thead>
          <tbody>
          <tr *ngFor="let movie of moviesWithTagline">
            <td>{{ movie.id }}</td>
            <td>{{ movie.name }}</td>
            <td>{{ movie.creationDate }}</td>
            <td>{{ movie.oscarsCount }}</td>
            <td>{{ movie.budget }}</td>
            <td>{{ movie.totalBoxOffice }}</td>
            <td>{{ movie.mpaaRating }}</td>
            <td>{{ movie.length }}</td>
            <td>{{ movie.goldenPalmCount }}</td>
            <td>{{ movie.usaBoxOffice }}</td>
            <td>{{ movie.tagline }}</td>
            <td>{{ movie.genre }}</td>

            <!-- Coordinates -->
            <td>
              <div class="attribute-label">X:</div>
              <div>{{ movie.coordinates.x }}</div>
              <div class="attribute-label">Y:</div>
              <div>{{ movie.coordinates.y }}</div>
            </td>

            <!-- Director -->
            <td>
              <div class="object-header">Director's info</div>
              <div class="object-attributes">
                <div>Name: {{ movie.director.name }}</div>
                <div>Eye Color: {{ movie.director.eyeColor }}</div>
                <div>Hair Color: {{ movie.director.hairColor }}</div>
                <div>Location: {{ movie.director.location.name }} ({{ movie.director.location.x }}
                  , {{ movie.director.location.y }}, {{ movie.director.location.z }})
                </div>
                <div>Height: {{ movie.director.height }}</div>
                <div>Nationality: {{ movie.director.nationality }}</div>
              </div>
            </td>

            <!-- Screenwriter -->
            <td>
              <div class="object-header">Screenwriter's info</div>
              <div class="object-attributes">
                <div>Name: {{ movie.screenwriter.name }}</div>
                <div>Eye Color: {{ movie.screenwriter.eyeColor }}</div>
                <div>Hair Color: {{ movie.screenwriter.hairColor }}</div>
                <div>Location: {{ movie.screenwriter.location.name }} ({{ movie.screenwriter.location.x }}
                  , {{ movie.screenwriter.location.y }}, {{ movie.screenwriter.location.z }})
                </div>
                <div>Height: {{ movie.screenwriter.height }}</div>
                <div>Nationality: {{ movie.screenwriter.nationality }}</div>
              </div>
            </td>

            <!-- Operator -->
            <td>
              <div class="object-header">Operator's info</div>
              <div class="object-attributes">
                <div>Name: {{ movie.operator.name }}</div>
                <div>Eye Color: {{ movie.operator.eyeColor }}</div>
                <div>Hair Color: {{ movie.operator.hairColor }}</div>
                <div>Location: {{ movie.operator.location.name }} ({{ movie.operator.location.x }}
                  , {{ movie.operator.location.y }}, {{ movie.operator.location.z }})
                </div>
                <div>Height: {{ movie.operator.height }}</div>
                <div>Nationality: {{ movie.operator.nationality }}</div>
              </div>
            </td>
          </tr>
          </tbody>
        </table>
      </div>
      <ng-template #notFound>
        <p>Объект не найден</p>
      </ng-template>
    </div>
  </div>

  <!-- Модальное окно для операции 3: Уникальные USABoxOffice -->
  <div class="modal" *ngIf="uniqueUsaBoxOfficesFlag">
    <div class="modal-content">
      <span class="close-btn" (click)="uniqueUsaBoxOfficesFlag = false">&times;</span>
      <h2>Уникальные значения USABoxOffice</h2>
      <ul>
        <li *ngFor="let boxOffice of uniqueUsaBoxOffices">{{ boxOffice }}</li>
      </ul>
    </div>
  </div>

  <!-- Модальное окно для операции 4: Операторы без Оскаров -->
  <div class="modal" *ngIf="operatorsWithoutOscarsFlag">
    <div class="modal-content">
      <span class="close-btn" (click)="operatorsWithoutOscarsFlag = false">&times;</span>
      <h2>Операторы без Оскаров</h2>
      <ul>
        <li *ngFor="let operator of operatorsWithoutOscars">{{ operator.name }}</li>
      </ul>
    </div>
  </div>

  <!-- Модальное окно для операции 5: Добавить Оскар фильмам категории R -->
  <div class="modal" *ngIf="addOscarFlag">
    <div class="modal-content">
      <span class="close-btn" (click)="addOscarFlag = false">&times;</span>
      <h2>Добавлено Оскаров фильмам с рейтингом R</h2>
      <p>Успешно добавлено по одному "Оскару" каждому фильму с рейтингом R.</p>
    </div>
  </div>

</div>
